{% extends "_base.html" %}
{% block content %}
<h4 class="mb-3">Request Pass</h4>

<form method="post" class="card">
  <div class="card-body">
    <div class="row g-3">
      <div class="col-md-6">
        <label class="form-label">Destination</label>
        <select name="destination_id" class="form-select" required>
          <option value="">Choose…</option>
          {% for d in destinations %}
            <option value="{{ d.id }}">{{ d.name }} ({{ d.default_minutes }} min)</option>
          {% endfor %}
        </select>
      </div>

      {% if auto_assigned_note %}
      <div class="col-md-6">
        <label class="form-label">Assignment</label>
        <input class="form-control" value="{{ auto_assigned_note }}" readonly>
      </div>
      {% elif enrollments and enrollments|length > 0 %}
      <div class="col-md-6">
        <label class="form-label">Class Period</label>
        <select name="class_period_id" class="form-select" required>
          <option value="">Select your current class…</option>
          {% for e in enrollments %}
            <option value="{{ e.class_period.id }}">{{ e.class_period.name }} ({{ e.class_period.teacher.full_name }})</option>
          {% endfor %}
        </select>
        <div class="form-text">This routes your request to the correct teacher.</div>
      </div>
      {% else %}
      <div class="col-md-6">
        <label class="form-label">Teacher</label>
        <select name="teacher_id" class="form-select" required>
          <option value="">Select teacher…</option>
          {% for t in teachers %}
            <option value="{{ t.id }}">{{ t.full_name }}</option>
          {% endfor %}
        </select>
        <div class="form-text">No enrollments found; select the teacher to receive your request.</div>
      </div>
      {% endif %}
    </div>

    <div class="mt-3 d-flex justify-content-end">
      <button class="btn btn-primary" type="submit">Request</button>
    </div>
  </div>
</form>
{% endblock %}
